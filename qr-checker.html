<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>음료수령 중복 체크</title>
  <style>
    /* 화면 전체를 사용해서 글자 정중앙 배치 */
    body, html {
      height: 100%;
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f9f9f9;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: #333;
    }

    #message {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 30px;
    }

    #claim-btn {
      font-size: 1.5em;
      padding: 15px 40px;
      background-color: #1976d2;
      border: none;
      border-radius: 50px;
      color: white;
      cursor: pointer;
      box-shadow: 0 8px 15px rgba(25, 118, 210, 0.3);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }
    #claim-btn:hover {
      background-color: #0d47a1;
      box-shadow: 0 12px 20px rgba(13, 71, 161, 0.5);
    }
  </style>
</head>
<body>

  <div id="message">잠시만 기다려주세요...</div>
  <button id="claim-btn" style="display:none;">수령하기</button>

  <script>
    // URL에서 code 파라미터 가져오기
    function getParameterByName(name) {
      const url = window.location.href;
      name = name.replace(/[\[\]]/g, '\\$&');
      const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
      const results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    const code = getParameterByName('code') || 'default_drink';
    const storageKey = 'drink_received_' + code;

    const messageDiv = document.getElementById('message');
    const claimBtn = document.getElementById('claim-btn');

    function updateUI() {
      if (localStorage.getItem(storageKey)) {
        // 이미 수령했으면
        messageDiv.textContent = '이미 음료를 수령했습니다.';
        claimBtn.style.display = 'none';
      } else {
        // 처음 방문했으면
        messageDiv.textContent = '음료 수령이 가능합니다!';
        claimBtn.style.display = 'inline-block';
      }
    }

    claimBtn.addEventListener('click', () => {
      localStorage.setItem(storageKey, 'true');
      messageDiv.textContent = '음료를 수령했습니다!';
      claimBtn.style.display = 'none';
    });

    // 페이지 로드 시 UI 업데이트
    window.onload = updateUI;
  </script>
</body>
</html>
